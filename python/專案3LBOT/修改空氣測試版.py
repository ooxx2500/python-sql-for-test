# -*- coding: utf-8 -*-
"""
Created on Wed Jul 29 21:47:12 2020

@author: 莫再提
"""
import datetime
import time
import requests
from bs4 import BeautifulSoup
import csv #載入csv套件
import pandas as pd #載入pandas 取名為pd
import datetime
import io

import re
stock_num=['00637L', '3481', '2409', '2344', '0056', '2888', '00633L', '2317', '00655L', '2303', '2330', '2337', '2882', '2883', '2002', '2887', '2892', '2323', '1314', '2890', '2884', '0050', '00636', '2880', '2834', '0061', '2823', '00850', '1303', '2891', '2885', '00861', '2881', '2448', '2889', '2324', '6116', '5880', '2349', '006205', '8150', '2363', '2886', '2801', '2498', '2618', '2308', '2603', '2449', '1309', '2313', '00739', '2841', '9904', '2458', '2353', '00669R', '1909', '00692', '6005', '2392', '2347', '6505', '2105', '2456', '00643', '3019', '3673', '2412', '3038', '3706', '2867', '3035', '2354', '2408', '1907', '2515', '3042', '5871', '2312', '2838', '2454', '5471', '2104', '2102', '2014', '2342', '1305', '1402', '2812', '006207', '1312', '00783', '2377', '4904', '1718', '2369', '2535', '6153', '2845', '2855', '00648R', '3189', '006206', '2352', '8016', '2401', '2614', '00752', '4935', '4968', '1326', '2489', '1605', '2610', '00639', '1802', '8213', '2520', '6592', '2820', '2481', '2505', '8163', '00651R', '2027', '6278', '3682', '3702', '1101', '00671R', '2897', '2478', '2340', '2101', '1103', '2393', '1609', '3338', '4119', '3052', '2455', '1313', '2633', '6213', '1304', '8046', '3443', '2108', '2338', '1201', '3698', '3090', '2474', '2402', '6120', '1514', '9945', '1905', '4915', '2601', '8215', '2511', '2023', '3006', '1519', '1515', '1789', '3437', '3023', '2103', '00701', '3596', '2609', '2345', '3037', '6251', '2426', '4906', '5388', '4943', '9938', '2106', '1308', '3532', '3515', '2547', '3005', '3036', '00642U', '2316', '2328', '1722', '2442', '2723', '3413', '8110', '4106', '3380', '1444', '6271', '2453', '2905', '2208', '3060', '2537', '2634', '1218', '1417', '00830', '2388', '3026', '2399', '00640L', '6282', '2395', '3533', '3665', '2368', '1708', '6669', '2484', '2331', '1710', '00646', '5531', '1409', '1701', '2355', '3034', '1301', '4934', '8131', '2301', '8021', '9939', '6443', '1210', '00738U', '2406', '3406', '2534', '2376', '1319', '6168', '00703', '3024', '6582', '5522', '00713', '1325', '6558', '1598', '2031', '2461', '5519', '2375', '4133', '2204', '8103', '2836', '9944', '1455', '8271', '2912', '6226', '9914', '3605', '2501', '2362', '2492', '2923', '9919', '00737', '00875', '6142', '2538', '3705', '2471', '3030', '1612', '3209', '8210', '6416', '1216', '8464', '6412', '1447', '3703', '1452', '00762', '1464', '2428', '4532', '5607', '2913', '2049', '6230', '1736', '1522', '5534', '00728', '4976', '4927', '4967', '4536', '1104', '1307', '1709', '1532', '3031', '3015', '2467', '8926', '6166', '2414', '0054', '6552', '2107', '1449', '6202', '1590', '1762', '2608', '2849', '2206', '5876', '5243', '8404', '9935', '00730', '2207', '3694', '1416', '1460', '2704', '1506', '1714', '1217', '1773', '9940', '8429', '1717', '2017', '2427', '4306', '2485', '3661', '3257', '00690', '6155', '5269', '2524', '1108', '3048', '020015', '00670L', '6672', '6591', '3518', '6541', '6414', '2405', '3044', '1604', '6283', '2706', '9908', '4426', '1614', '00641R', '2419', '4942', '1712', '8462', '3645', '3027', '5305', '2539', '2852', '3311', '2495', '3543', '3583', '1316', '1760', '6451', '2468', '4104', '1733', '3059', '3504', '3010', '6165', '6525', '3231', '6224', '1315', '1435', '1589', '1528', '3419', '2034', '00743', '6668', '2433', '6452', '1321', '2038', '2516', '2606', '2444', '6189', '2929', '2851', '3029', '1904', '2705', '3607', '6214', '4956', '2228', '1527', '2530', '5007', '2545', '2850', '2642', '6024', '2009', '5258', '1526', '1337', '5515', '2022', '3094', '1442', '1507', '3376', '1906', '4977', '3530', '2908', '2605', '2707', '1730', '2527', '2404', '1110', '2450', '3494', '9902', '8463', '6598', '9930', '6183', '5285', '4938', '020000', '2906', '1109', '00665L', '3588', '2329', '1340', '2360', '00681R', '6136', '2314', '2007', '2390', '1808', '6531', '3013', '1338', '3028', '1419', '2486', '1414', '2013', '4552', '1466', '1616', '2832', '2239', '8454', '1806', '3018', '5203', '9924', '2612', '3356', '1503', '2939', '1707', '1219', '2227', '6108', '9925', '1423', '020008', '3050', '6192', '1618', '2010', '1203', '2373', '5907', '3454', '1451', '1231', '6605', '2029', '1795', '2012', '8499', '4526', '4148', '1537', '2911', '4137', '2305', '1721', '1903', '2482', '2441', '2597', '6698', '8033', '9927', '2701', '3055', '2617', '00731', '00675L', '2460', '4766', '4581', '006208', '00674R', '4155', '8261', '9937', '2420', '910322', '5234', '3149', '3296', '3686', '00770', '4739', '1809', '2020', '4999', '00736', '6504', '2546', '4566', '2506', '01009T', '2415', '8996', '5288', '1732', '2443', '2028', '4540', '6115', '00678', '3266', '8481', '3591', '00660', '2613', '9934', '1323', '4545', '1541', '2509', '9905', '00865B', '1533', '4919', '1459', '1524', '6133', '3058', '2430', '2616', '5525', '2611', '3312', '2543', '1615', '2483', '2497', '3032', '1232', '2528', '9941', '1445', '1473', '4952', '4576', '2477', '6128', '6152', '1603', '1225', '1540', '1713', '2397', '8443', '1468', '8473', '2514', '2358', '3679', '8411', '3501', '00763U', '1443', '2380', '1339', '2069', '3004', '1592', '3164', '1235', '1617', '9942', '2727', '4720', '6216', '1776', '2385', '2440', '00735', '1454', '00851', '9918', '2904', '00652', '2015', '4141', '008201', '2032', '6581', '2739', '1432', '01003T', '1456', '1413', '5533', '2702', '2540', '9926', '2423', '00709', '1463', '4438', '00654R', '1525', '3550', '6164', '3617', '3346', '911868', '2630', '3622', '6184', '00714', '2910', '6464', '3002', '8478', '8114', '6409', '3593', '1220', '6281', '1446', '6196', '4989', '3701', '9929', '00688L', '00766L', '1587', '2008', '1530', '2002A', '1324', '3305', '8480', '8072', '5484', '1441', '6477', '4571', '1583', '3041', '1568', '1521', '1724', '1727', '1437', '1535', '1470', '2488', '2024', '3021', '2115', '6655', '8374', '2901', '4764', '3025', '8104', '1726', '2413', '1438', '2429', '1611', '1805', '3167', '8482', '9943', '4144', '6579', '6201', '006203', '1233', '5284', '2748', '00866', '1236', '1786', '00706L', '3054', '1436', '4994', '2712', '8222', '3432', '4737', '6491', '1517', '912000', '1725', '1453', '3229', '8367', '2033', '8201', '6671', '4912', '1465', '1410', '6442', '6197', '1720', '3528', '3308', '00661', '1539', '6405', '0052', '2062', '5546', '1810', '2936', '3130', '4562', '6172', '1735', '0057', '5538', '1474', '3046', '8442', '6625', '8940', '6641', '910861', '1531', '2465', '4807', '9931', '1516', '2382', '4755', '8488', '2438', '2891C', '0051', '1817', '00663L', '8427', '6117', '6449', '2491', '1256', '1457', '8467', '3011', '8497', '2881B', '2462', '6415', '4572', '1341', '3416', '1101B', '006204', '1513', '00625K', '2348', '00689R', '9912', '2424', '4439', '6235', '6131', '6666', '5906', '00636K', '4190', '9941A', '00657', '00775B', '00732', '00707R', '00691R', '3383', '00657K', '00668K', '4557', '00673R', '2243', '2838A', '0053', '2903', '3321', '2464', '00693U', '1626', '00666R', '8070', '02001L', '00733', '4930', '4763', '6209', '2059', '1312A', '1737', '1783', '0055', '2881A', '9105', '8341', '2233', '2374', '5706', '4555', '00711B', '2466', '2731', '2357', '00715L', '2816', '2887F', '00682U', '2459', '2114', '3702A', '00685L', '6674', '2536', '2722', '3008', '1472', '6533', '2493', '2030', '00742', '5283', '2476', '020011', '00757', '5434', '00700', '6215', '2383', '9917', '2431', '00684R', '4916', '3033', '6205', '2236', '5225', '9955', '2351', '1608', '1234', '1439', '6670', '00702', '01001T', '1529', '5521', '00645', '1558', '2496', '00683L', '00662', '6243', '1227', '00680L', '2607', '4560', '2451', '9921', '9802', '6277', '4961', '3708', '1434', '4108', '6206', '00686R', '6431', '8466', '020012', '3057', '1102', '2387', '6715', '1477', '9188', '2882A', '2231', '4722', '5608', '00635U', '9958', '00710B', '4564', '2109', '2809', '00753L', '00668', '2480', '1723', '00647L', '1467', '9933', '9136', '00672L', '4746', '00771', '4414', '6141', '2915', '8011', '6139', '1734', '1215', '1702', '3003', '9907', '3040', '3022', '9911', '020016', '8422', '2439', '2365', '3450', '3563', '2615', '2302', '1536', '8028', '2637', '3062', '1310', '5264', '2548', '5215', '3047', '8249', '9910', '1731', '2636', '1560', '1582', '3712', '8105', '2457', '3535', '2425', '6112', '3669', '3014', '3017', '3049', '8081', '4551', '2417', '4142', '4164', '1711', '00676R', '2542', '1440', '6573', '1476', '3557', '6285', '6288', '1504', '6456', '2504', '2379', '00717', '00650L', '2006', '3056', '6706', '3045', '6177', '2421', '6239', '2359', '2472', '00708L', '00712', '2356', '3704', '4958', '3576', '1229', '6176', '3545', '3016', '5469', '00631L', '4960', '6191', '9946', '8039', '2371', '00656R', '6269', '8112', '2201', '2436', '2332', '00664R', '3653', '6257', '00852L', '2327', '2367', '00653L', '00634R', '00632R', '3711', '00638R', '00677U','00679B', '00687B', '00694B', '00695B', '00696B', '00697B', '00718B', '00719B', '00720B', '00721B', '00722B', '00723B', '00724B', '00725B', '00726B', '00727B', '00734B', '00740B', '00741B', '00744B', '00745B', '00746B', '00747B', '00748B', '00749B', '00750B', '00751B', '00754B', '00755B', '00756B', '00758B', '00759B', '00760B', '00761B', '00764B', '00765B', '00768B', '00772B', '00773B', '00777B', '00778B', '00779B', '00780B', '00781B', '00782B', '00784B', '00785B', '00786B', '00787B', '00788B', '00789B', '00790B', '00791B', '00792B', '00793B', '00794B', '00795B', '00796B', '00799B', '00831B', '00832B', '00833B', '00834B', '00836B', '00838B', '00839B', '00840B', '00841B', '00842B', '00843B', '00844B', '00845B', '00846B', '00847B', '00848B', '00849B', '00853B', '00854B', '00855B', '00856B', '00857B', '858', '00859B', '00860B', '00862B', '00863B', '00864B', '00867B', '00868B', '00869B', '00870B', '00871B', '00872B', '00873B', '00874B', '877', '1240', '1258', '1336', '1565', '1569', '1580', '1586', '1591', '1593', '1597', '1742', '1752', '1777', '1781', '1784', '1785', '1799', '1815', '2063', '2064', '2065', '2066', '2221', '2230', '2596', '2640', '2641', '2643', '2726', '2729', '2732', '2743', '2745', '2752', '2928', '3064', '3067', '3071', '3073', '3078', '3081', '3083', '3088', '3092', '3105', '3114', '3118', '3122', '3128', '3131', '3141', '3144', '3152', '3163', '3169', '3171', '3176', '3178', '3191', '3202', '3205', '3206', '3211', '3213', '3217', '3218', '3221', '3224', '3227', '3228', '3232', '3234', '3236', '3252', '3260', '3264', '3265', '3272', '3288', '3289', '3290', '3293', '3297', '3303', '3306', '3313', '3317', '3323', '3324', '3325', '3360', '3362', '3363', '3372', '3373', '3374', '3388', '3390', '3402', '3434', '3438', '3441', '3444', '3455', '3466', '3479', '3483', '3484', '3490', '3491', '3492', '3498', '3499', '3508', '3511', '3512', '3522', '3523', '3526', '3527', '3529', '3531', '3537', '3540', '3541', '3546', '3548', '3551', '3552', '3556', '3558', '3564', '3567', '3570', '3580', '3581', '3587', '3594', '3597', '3609', '3611', '3615', '3623', '3624', '3625', '3628', '3629', '3630', '3652', '3664', '3666', '3675', '3680', '3687', '3689', '3691', '3693', '3707', '3709', '3710', '3713', '4102', '4105', '4107', '4109', '4111', '4113', '4114', '4116', '4120', '4121', '4123', '4126', '4127', '4128', '4129', '4130', '4139', '4147', '4152', '4153', '4154', '4157', '4160', '4161', '4162', '4163', '4167', '4168', '4171', '4173', '4174', '4175', '4183', '4188', '4192', '4205', '4304', '4401', '4432', '4433', '4502', '4503', '4506', '4528', '4529', '4533', '4538', '4543', '4550', '4561', '4580', '4702', '4707', '4711', '4714', '4716', '4721', '4726', '4728', '4729', '4735', '4736', '4741', '4743', '4744', '4745', '4747', '4754', '4760', '4803', '4804', '4903', '4908', '4909', '4911', '4924', '4931', '4933', '4939', '4950', '4953', '4966', '4971', '4973', '4974', '4979', '4991', '4995', '5009', '5011', '5014', '5016', '5201', '5206', '5209', '5210', '5211', '5212', '5213', '5220', '5223', '5227', '5230', '5245', '5251', '5263', '5272', '5274', '5278', '5281', '5287', '5289', '5291', '5299', '5302', '5306', '5309', '5314', '5315', '5321', '5324', '5328', '5340', '5344', '5345', '5347', '5349', '5351', '5353', '5355', '5356', '5371', '5383', '5386', '5392', '5403', '5410', '5425', '5426', '5432', '5438', '5439', '5443', '5450', '5452', '5457', '5464', '5465', '5474', '5478', '5481', '5483', '5487', '5488', '5490', '5493', '5498', '5508', '5511', '5512', '5520', '5523', '5529', '5530', '5536', '5543', '5604', '5609', '5701', '5820', '5903', '5904', '5905', '6015', '6016', '6020', '6021', '6023', '6026', '6101', '6104', '6109', '6111', '6114', '6118', '6121', '6122', '6123', '6124', '6125', '6126', '6127', '6129', '6134', '6138', '6140', '6143', '6144', '6146', '6147', '6148', '6150', '6156', '6158', '6160', '6161', '6163', '6167', '6169', '6170', '6171', '6173', '6174', '6175', '6179', '6180', '6182', '6185', '6186', '6187', '6188', '6190', '6194', '6195', '6201', '6203', '6204', '6207', '6208', '6210', '6217', '6219', '6220', '6221', '6222', '6223', '6227', '6231', '6233', '6234', '6237', '6244', '6245', '6259', '6261', '6263', '6265', '6266', '6270', '6274', '6275', '6276', '6279', '6284', '6290', '6291', '6292', '6294', '6411', '6419', '6426', '6432', '6435', '6438', '6441', '6446', '6457', '6461', '6462', '6469', '6470', '6472', '6485', '6486', '6488', '6492', '6494', '6496', '6497', '6499', '6508', '6509', '6510', '6514', '6516', '6523', '6527', '6530', '6532', '6535', '6538', '6547', '6548', '6560', '6561', '6568', '6570', '6576', '6577', '6578', '6588', '6589', '6590', '6594', '6603', '6612', '6613', '6616', '6624', '6629', '6642', '6643', '6654', '6662', '6664', '6667', '6679', '6683', '6690', '6697', '6716', '6732', '6803', '8024', '8027', '8034', '8038', '8040', '8042', '8043', '8044', '8048', '8049', '8050', '8054', '8059', '8064', '8066', '8069', '8076', '8083', '8084', '8085', '8086', '8088', '8091', '8092', '8096', '8099', '8107', '8109', '8111', '8121', '8147', '8155', '8171', '8182', '8183', '8234', '8240', '8255', '8277', '8279', '8284', '8289', '8299', '8349', '8358', '8383', '8390', '8403', '8406', '8409', '8410', '8415', '8421', '8426', '8431', '8432', '8433', '8435', '8436', '8437', '8446', '8476', '8477', '8489', '8916', '8916A', '8924', '8928', '8929', '8932', '8933', '8936', '8938', '8942', '9951', '20001', '20003', '20010', '20014', '20017']

stock_name=['元大滬深300正2', '群創', '友達', '華邦電', '元大高股息', '新光金', '富邦上証正2', '鴻海', '國泰中國A50正2', '聯電', '台積電', '旺宏', '國泰金', '開發金', '中鋼', '台新金', '第一金', '中環', '中石化', '永豐金', '玉山金', '元大台灣50', '國泰中國A50', '華南金', '臺企銀', '元大寶滬深', '中壽', '元大臺灣ESG永續', '南亞', '中信金', '元大金', '元大全球未來通訊', '富邦金', '晶電', '國票金', '仁寶', '彩晶', '合庫金', '錸德', '富邦上証', '南茂', '矽統', '兆豐金', '彰銀', '宏達電', '長榮航', '台達電', '長榮', '京元電子', '台達化', '華通', '元大MSCI A股', '台開', '寶成', '義隆', '宏碁', '國泰美國道瓊反1', '榮成', '富邦公司治理', '群益證', '正崴', '聯強', '台塑化', '正新', '奇力新', '群益深証中小', '亞光', 'TPK-KY', '中華電', '全台', '神達', '三商壽', '智原', '鴻準', '南亞科', '永豐餘', '中工', '晶技', '中租-KY', '金寶', '聯邦銀', '聯發科', '松翰', '國際中橡', '泰豐', '中鴻', '茂矽', '華夏', '遠東新', '台中銀', 'FH滬深', '國喬', '富邦中証500', '微星', '遠傳', '中纖', '菱生', '達欣工', '嘉聯益', '遠東銀', '統一證', '元大S&P500反1', '景碩', '元大上證50', '佳世達', '矽創', '凌陽', '東森', '中信中國50', '茂林-KY', '立積', '台化', '瑞軒', '華新', '華航', '富邦深100', '台玻', '志超', '冠德', '和潤企業', '華票', '強茂', '國揚', '達方', 'FH香港反1', '大成鋼', '台表科', '亞太電', '大聯大', '台泥', '富邦NASDAQ反1', '王道銀行', '大毅', '光磊', '南港', '嘉泥', '億光', '大亞', '泰碩', '旭富', '夆典', '全新', '聯成', '台灣高鐵', '聯茂', '台聚', '南電', '創意', '南帝', '光罩', '味全', '隆達', '日電貿', '可成', '毅嘉', '達運', '亞力', '潤泰新', '華紙', '致伸', '益航', '明基材', '太子', '燁輝', '晶豪科', '華城', '力山', '神隆', '榮創', '信邦', '台橡', '國泰股利精選30', '智易', '陽明', '智邦', '欣興', '定穎', '鼎元', '正文', '中磊', '康控-KY', '百和', '建大', '亞聚', '台勝科', '華擎', '日勝生', '神基', '文曄', '元大S&P石油', '楠梓電', '廣宇', '台肥', '新美齊', '美食-KY', '京鼎', '華東', '雃博', '明泰', '力麗', '同欣電', '凌群', '三商', '台船', '銘異', '聯上發', '漢翔', '泰山', '嘉裕', '國泰費城半導體', '威盛', '禾伸堂', '映泰', '富邦日本正2', '康舒', '研華', '嘉澤', '貿聯-KY', '金像電', '東鹼', '緯穎', '希華', '精英', '東聯', '元大S&P500', '鄉林', '新纖', '中化', '敬鵬', '聯詠', '台塑', '太極', '福懋科', '光寶科', '尖點', '宏全', '元晶', '大成', '元大道瓊白銀', '國碩', '玉晶光', '宏盛', '技嘉', '東陽', '宏齊', '台新MSCI中國', '憶聲', '申豐', '遠雄', '元大台灣高息低波', '恆大', '興能高', '岱宇', '新光鋼', '光群雷', '隆大', '凱美', '亞諾法', '中華', '瀚荃', '高雄銀', '新麗', '集盛', '宇瞻', '統一超', '光鼎', '美利達', '宏致', '國建', '藍天', '華新科', '鼎固-KY', '康那香', '國泰AI+Robo', '國泰網路資安', '友勁', '基泰', '永信', '資通', '德律', '宏泰', '全科', '勤誠', '瑞祺電通', '統一', '億豐', '群電', '力鵬', '欣陸', '宏益', '元大全球AI', '得力', '興勤', '瑞智', '遠雄港', '農林', '上銀', '超眾', '喬山', '堤維西', '長虹', '第一金工業30', '佳凌', '泰鼎-KY', '十銓', '拓凱', '環泥', '三芳', '和益', '勤美', '佰鴻', '全漢', '志聖', '台汽電', '凌華', '精技', '元大台商50', '易華電', '厚生', '佳和', '盛群', '亞德客-KY', '中化生', '嘉里大榮', '安泰銀', '三陽工業', '上海商銀', '乙盛-KY', '百和興業-KY', '慶豐富', '富邦臺灣優質高息', '和泰車', '海華', '廣豐', '宏遠', '國賓', '正道', '和桐', '愛之味', '勝一', '信義', '金麗-KY', '長興', '官田鋼', '三商電', '炎洲', '兆赫', '世芯-KY', '虹冠電', '兆豐藍籌30', '鈞寶', '祥碩', '京城', '幸福', '益登', '統一MSCI美低波N', '富邦NASDAQ正2', '騰輝電子-KY', '動力-KY', '柏騰', '泰福-KY', '樺漢', '浩鑫', '健鼎', '聲寶', '淳安', '第一店', '大台北', '利勤', '三洋電', '富邦日本反1', '仲琦', '嘉彰', '興農', '柏文', '達邁', '盛達', '敦南', '櫻花建', '第一保', '閎暉', '普安', '州巧', '辛耘', '上曜', '寶齡富錦', '訊芯-KY', '華經', '佳醫', '五鼎', '華晶科', '揚明光', '華立', '捷泰', '捷敏-KY', '緯創', '聚鼎', '達新', '中福', '永冠-KY', '恩德', '譁裕', '允強', '國泰中國A150', '中揚光', '互盛電', '康友-KY', '大洋', '海光', '新建', '裕民', '兆勁', '豐藝', '淘帝-KY', '中再保', '零壹', '正隆', '六福', '谷崧', '精誠', '光鋐', '劍麟', '鑽全', '華建', '三星', '皇翔', '新產', '宅配通', '群益期', '第一銅', '虹堡', '日馳', '再生-KY', '建國', '聚亨', '聯傑', '名軒', '永大', '新日興', '寶隆', '眾達-KY', '晶相光', '特力', '新興', '晶華', '花仙子', '宏璟', '漢唐', '東泥', '神腦', '誠研', '台火', '潤泰材', 'ABC-KY', '中聯資源', '關貿', '界霖', '和碩', '富邦特選蘋果N', '高林', '信大', '富邦恒生國企正2', '通嘉', '華泰', '勝悅-KY', '致茂', '元大美債20反1', '富爾特', '台揚', '燁興', '云辰', '潤隆', '愛普', '晟銘電', '廣華-KY', '增你強', '新紡', '一詮', '東和', '中鋼構', '力達-KY', '聚隆', '億泰', '台產', '英利-KY', '富邦媒', '冠軍', '同開', '訊連', '福興', '中航', '奇偶', '士電', '凱羿-KY', '葡萄王', '福壽', '裕日車', '競國', '新保', '利華', '元大特股高息N', '鈺德', '巨路', '合機', '春源', '味王', '震旦行', '大洋-KY', '晶睿', '年興', '聯華食', '帝寶', '盛餘', '美時', '春雨', '鼎炫-KY', '東台', '全宇生技-KY', '廣隆', '麗嬰房', '麗豐-KY', '全友', '三晃', '士紙', '連宇', '超豐', '潤弘', '旭暉應材', '雷虎', '泰銘', '萬企', '蔚華科', '台航', 'FH富時高息低波', '富邦臺灣加權正2', '建通', '南寶', '光隆精密-KY', '富邦台50', '元大S&P黃金反1', '訊映', '富鼎', '全國', '新巨', '康師傅-DR', '達興材料', '正達', '勝德', '達能', '國泰北美科技', '康普', '中釉', '美亞', '鑫禾', '國泰新興市場', '南六', '根基', '時碩工業', '太設', '王道圓滿R1', '錩新', '高力', '豐祥-KY', '毛寶', '億麗', '威致', '全球傳動', '鎰勝', '群益NBI生技', '昇陽', '政伸', '艾笛森', '元大歐洲50', '中櫃', '成霖', '永裕', '銘鈺', '錩泰', '全坤建', '大華', '國泰US短期公債', '車王電', '新唐', '聯發', '耿鼎', '金橋', '立德', '燦坤', '山隆', '順天', '志信', '弘憶股', '皇昌', '大山', '百容', '怡利電', '偉訓', '大統益', '皇普', '裕融', '大宇', '台南', '凌通', '大銀微系統', '美隆電', '上福', '百一', '華電', '福懋油', '喬福', '國化', '友通', '阿瘦', '昶和', '山林水', '龍邦', '廷鑫', '新至陞', '福貞-KY', '維熹', '街口道瓊銅', '立益', '虹光', '昭輝', '運錩', '豐達科', '英瑞-KY', '景岳', '興泰', '榮星', '茂順', '王品', '德淵', '居易', '展宇', '群光', '太空梭', '國泰臺韓科技', '台富', '台新全球AI', '欣天然', '匯僑', '富邦印度', '豐興', '龍燈-KY', 'BP上證50', '新鋼', '鋼聯', '寒舍', '大魯閣', '兆豐新光R1', '怡華', '宏洲', '皇鼎', '華園', '愛山林', '新海', '固緯', '富邦歐洲', '強盛', '廣越', '富邦印度反1', '江申', '聯穎', '華興', '碩天', '麗清', '同方友友-DR', '亞航', '洋華', '大豐電', '群益道瓊美國地產', '統領', '台數科', '歐格', '東哥遊艇', '振樺電', '旭隼', '力銘', '台榮', '全國電', '宏和', '帆宣', '榮科', '大眾控', '秋雨', '國泰20年美債正2', '台新MSCI中國正2', '吉茂', '高興昌', '亞崴', '中鋼特', '地球', '昇貿', '泰昇-KY', '陞泰', '慧友', '大東', '安集', '鈞興-KY', '程泰', '揚智', '倉佑', '大億', '台硝', '中華化', '勤益控', '中宇', '大統新創', '漢平', '志聯', '鴻名', '六暉-KY', '科定', '羅昇', '欣欣', '雙鍵', '星通', '錸寶', '永記', '環科', '裕豐', '銘旺科', '中電', '寶徠', '大量', '商億-KY', '好樂迪', '康聯-KY', '研揚', '亞弘電', '元大MSCI台灣', '天仁', 'jpp-KY', '雲品', '新光Shiller CAPE', '宏亞', '科妍', '元大S&P日圓正2', '立萬利', '華友聯', '傳奇', '遠雄來', '寶一', '台端', '華廣', '晶碩', '利奇', '晨訊科-DR', '元禎', '大將', '晟鈦', '建新國際', '佳大', '無敵', '三能-KY', '聯德控股-KY', '偉全', '南染', '光聖', '佳必琪', '生達', '安馳', '聯德', '元大日經225', '巨庭', '悅城', '富邦科技', '橋椿', '永固-KY', '和成', '客思達-KY', '一零四', '穎漢', '互億', '日勝化', '富邦摩台', '東明-KY', '弘裕', '建碁', '威宏-KY', '必應', '新天地', '基士德-KY', '神州-DR', '高林股', '麗臺', '日成-KY', '欣高', '川飛', '廣達', '三福化', '吉源-KY', '翔耀', '中信金丙特', '元大中型100', '凱撒衛', '國泰臺灣加權正2', '基勝-KY', '迎廣', '鈺邦', '吉祥全', '鮮活果汁-KY', '宜進', '波力-KY', '今皓', '格威傳媒', '富邦金乙特', '良得電', '矽力-KY', '駐龍', '富林-KY', '融程電', '台泥乙特', '永豐臺灣加權', '中興電', '富邦上証+R', '海悅', '國泰20年美債反1', '偉聯', '隴華', '冠星-KY', '華孚', '鈞泰', '羅麗芬-KY', '台南-KY', '國泰中國A50+U', '佐登-KY', '裕融甲特', '國泰日經225', '新光投等債15+', '國泰RMB短期報酬', '元大S&P日圓反1', '兆豐藍籌30反1', '新世紀', '國泰日經225+U', '國泰美國道瓊+U', '永新-KY', '元大S&P原油反1', '宏旭-KY', '聯邦銀甲特', '元大電子', '遠百', '同泰', '盟立', '街口S&P黃豆', '艾美特-KY', '富邦恒生國企反1', '長華', '富邦蘋果正二N', '富邦臺灣中小', '燦星網', '材料-KY', '今國光', '川湖', '國喬特', '臺鹽', '和康生', '元大MSCI金融', '富邦特', '泰金寶-DR', '日友', '宇隆', '佳能', '鳳凰', '氣立', 'FH彭博新興債', '冠西電', '雄獅', '華碩', '街口布蘭特油正2', '旺旺保', '台新戊特二', '元大美元指數', '敦吉', '鑫永銓', '大聯大甲特', '群益臺灣加權正2', '鋐寶科技', '宏普', '夏都', '大立光', '三洋紡', '晶心科', '揚博', '彰源', '新光內需收益', '禾聯碩', '鉅祥', '統一微波高息20N', '統一FANG+', '崇越', '富邦恒生國企', '和椿', '台光電', '中保科', '聯昌', '元大美元指數反1', '事欣科', '威健', '詮欣', '百達-KY', '東科-KY', '佳龍', '順德', '華榮', '黑松', '中和', '復盛應用', '國泰標普低波高息', '土銀富邦R1', '樂士', '工信', '富邦日本', '伸興', '卓越', '元大美元指數正2', '富邦NASDAQ', '迅杰', '佳格', '元大美債20正2', '榮運', '強信-KY', '創見', '巨大', '鈺齊-KY', '宏正', '天鈺', '上緯投控', '福懋', '懷特', '飛捷', '群益臺灣加權反1', '光麗-KY', '美吉吉-KY', '富邦行動通訊N', '喬鼎', '亞泥', '精元', '嘉基', '聚陽', '精熙-DR', '國泰特', '為升', '國精化', '四維航', '元大S&P黃金', '世紀鋼', 'FH彭博高收益債', '元翎', '華豐', '京城銀', '中信中國50正2', '國泰美國道瓊', '敦陽科', '中碳', '元大S&P500正2', '南緯', '中鼎', '巨騰-DR', '元大S&P原油正2', '台耀', '元大US高息特別股', '如興', '柏承', '潤泰全', '台通', '亞翔', '杏輝', '卜蜂', '南僑', '健和興', '統一實', '遠見', '威強電', '櫻花', '統一MSCI美科技N', '可寧衛', '美律', '昆盈', '聯鈞', '牧德', '萬海', '麗正', '和大', '昇陽半導體', '慧洋-KY', '建漢', '台苯', '鎧勝-KY', '華固', '科嘉-KY', '訊舟', '菱光', '豐泰', '美吾華', '台驊投控', '中砂', '信錦', '永崴投控', '凌巨', '飛宏', '晶彩科', '承啟', '聚碩', '圓展', '聯陽', '奇鋐', '和鑫', '致新', '智伸科', '圓剛', '國光生', '承業醫', '永光', '富邦臺灣加權反1', '興富發', '南紡', '虹揚-KY', '儒鴻', '嘉威', '啟碁', '聯嘉', '東元', 'GIS-KY', '國產', '瑞昱', '富邦美國特別股', 'FH香港正2', '東和鋼鐵', '總太', '惠特', '台灣大', '達麗', '建準', '力成', '所羅門', '立隆電', '元大S&P黃金正2', 'FH富時不動產', '英業達', '合勤控', '臻鼎-KY', '聯合再生', '聯華', '瑞儀', '敦泰', '嘉晶', '瀚宇博', '元大台灣50正2', '誠美材', '精成科', '三發地產', '台虹', '大同', '國泰中國A50反1', '台郡', '至上', '裕隆', '偉詮電', '友訊', '國泰臺灣加權反1', '健策', '矽格', '國泰美國道瓊正2', '國巨', '燿華', '富邦印度正2', '富邦上証反1', '元大台灣50反1', '日月光投控', '元大滬深300反1', '富邦VIX','元大美債20年', '國泰20年美債', '富邦美債1-3', '富邦美債7-10', '富邦美債20年', '元大美債7-10', '富邦中國政策債', '元大美債1-3', '元大投資級公司債', '元大中國債3-5', '群益15年IG電信債', '群益15年IG科技債', '群益10年IG金融債', '國泰投資級公司債', '國泰5Y+新興債', '國泰1-5Y高收債', '台新JPM新興債', '富邦全球投等債', '富邦全球高收債', '國泰中國政金債5+', '富邦中政債0-1', '富邦A級公司債', 'FH中國政策債', '凱基中國債3-10', '凱基新興債10+', '凱基科技債10+', '元大AAA至A公司債', '群益AAA-AA公司債', '群益15年IG公用債', '群益15年EM主權債', 'FH能源債', 'FH製藥債', 'FH新興企業債', '國泰A級公司債', '群益25年美債', '群益中國政金債', 'FH20年美債', '中信高評級公司債', '中信優先金融債', '凱基AAA至A公司債', '凱基金融債20+', '凱基美債25+', '國泰A級金融債', '國泰A級科技債', '國泰A級公用債', '富邦中國投等債', '富邦金融投等債', '元大10年IG銀行債', '元大10年IG醫療債', '元大10年IG電能債', 'FH公司債A3', 'FH次順位IG金融債', 'FH美元信用債1-5Y', '群益A級公司債', '群益AAA-A醫療債', '群益7+中國政金債', '中信美國公債20年', '中信中國債7-10', '國泰A級醫療債', '新光美債1-3', '新光美債20+', '第一金美債20+', '第一金金融債10+', '永豐10年A公司債', '永豐7-10年中國債', '凱基醫療保健債', '凱基IG精選15+', '凱基AAA-AA公司債', '台新美元銀行債', '台新中國政策債', '新光15年IG金融債', '富邦新興投等債', '富邦歐洲銀行債', '中信美國市政債', '中信新興亞洲債', '中信EM主權債0-5', '統一美債10年Aa-A', '富邦全球保險債', '富邦全球能源債', '永豐1-3年美公債', '永豐20年美公債', '永豐美國500大', '群益0-1年美債', '群益1-5年IG債', '中信投資級公司債', '中信全球電信債', '中信美國公債0-1', '新光A-BBB電信債', 'FT1-3年美公債', 'FT10-25年公司債', '元大15年EM主權債', '元大中國政金債', '凱基美債1-3', '凱基新興債1-5', '凱基BBB公司債15+', 'FH中國5G', '茂生農經', '其祥-KY', '台翰', '精華', '濱川', '新麥', '和勤', '駿吉-KY', '祺驊', '直得', '台蠟', '南光', '生泰', '合世', '訊聯', '光洋科', '易威', '富喬', '世鎧', '晉椿', '世豐', '世德', '大甲', '泰茂', '綠意', '大車隊', '正德', '捷迅', '雅茗-KY', '瓦城', '六角', '山富', '五福', '豆府', '紅馬-KY', '泰偉', '全域', '協禧', '凱柏實業', '僑威', '聯亞', '網龍', '艾訊', '鴻碩', '穩懋', '好德', '進階', '笙泉', '昇銳', '弘塑', '晶宏', '新揚科', '璟德', '波若威', '亞信', '新洲', '基亞', '公準', '和進', '樺晟', '佰研', '志豐', '順達', '茂訊', '優群', '大學光', '台嘉碩', '三顧', '原相', '金麗科', '昱捷', '光環', '千如', '海灣', '威剛', '欣銓', '台星科', '東碩', '點晶', '宜特', '東浦', '鈊象', '杭特', '岱稜', '鼎天', '斐成', '尼克森', '加百裕', '雙鴻', '旭品', '尚立', '先進光', '上詮', '典範', '熱映', '精材', '崇越電', '旭軟', '漢科', '哲固', '類比科', '聯一光', '利機', '由田', '致振', '安勤', '力致', '崧騰', '單井', '昇達科', '長盛', '陽程', '環天科', '位速', '矽瑪', '皇龍', '御頂', '迎輝', '凡甲', '聚積', '力旺', '先益', '堡達', '曜越', '西柏', '宇峻', '兆利', '世禾', '同致', '禾瑞亞', '神準', '其陽', '逸昌', '大塚', '友威科', '博磊', '閎康', '磐儀', '映興', '東林', '鼎翰', '安可', '富晶通', '光頡', '西勝', '盈正', '地心引力', '新鉅科', '精聯', '安瑞-KY', '光耀', '德微', '家登', '歐買尬', '湧德', '碩禾', '營邦', '漢磊', '鑫聯大投控', '連展投控', '新晶投控', '永日', '東洋', '邦特', '加捷生醫', '濟生', '聯上', '健喬', '明基醫', '友華', '優盛', '晟德', '太醫', '天良', '中天', '聯合', '健亞', '馬光-KY', '中裕', '台微體', '鈺緯', '康樂-KY', '太景*-KY', '創源', '聿新科', '智擎', '鐿鈦', '展旺', '醣聯', '瑞基', '久裕', '浩鼎', '杏一', '福永生技', '安克', '杏國', '中華食', '勝昱', '東隆興', '銘旺實', '興采', '健信', '金雨', '崇友', '江興鍛', '淳紳', '協易機', '大詠城', '萬在', '長佳', '健椿', '捷流閥業', '中美實', '磐亞', '永純', '永捷', '大立', '美琪瑪', '永昕', '雙美', '熒茂', '豪展', '泰博', '泓瀚', '合一', '皇將', '合富-KY', '強生', '國碳科', '勤凱', 'VHQ-KY', '大略-KY', '聯光通', '前鼎', '新復興', '德英', '欣厚-KY', '新盛力', '友輝', '亞電', '牧東', '緯軟', '譜瑞-KY', 'IET-KY', '廣穎', '亞泰', '華星光', '環宇-KY', '晶達', '榮剛', '久陽', '建錩', '松和', '凱衛', '坤悅', '新鼎', '寶碩', '蒙恬', '凌網', '亞昕', '萬達光電', '安力-KY', '立凱-KY', '雷笛克光學', '智晶', '天鉞電', '智崴', '笙科', '信驊', '尚凡', '大峽谷-KY', '數字', '宜鼎', '邑昇', '杰力', '太欣', '桂盟', '系統電', '世紀', '光聯', '友銓', '士開', '華容', '建榮', '立衛', '天揚', '世界', '先豐', '鈺創', '台林', '佳總', '協益', '中光電', '金利', '青雲', '應華', '中菲', '國眾', '台半', '振發', '達威', '東友', '高技', '均豪', '寶聯通', '佶優', '宣德', '霖宏', '富驊', '聰泰', '智冠', '新華', '中美晶', '通泰', '松普', '同亨', '三聯', '凱崴', '永信建', '德昌', '力麒', '力泰', '豐謙', '志嘉', '龍巖', '聖暉', '崇佑-KY', '中連貨', '中菲行', '劍湖山', '日盛金', '全家', '寶雅', '南仁湖', '宏遠證', '康和證', '大展證', '大慶證', '元大期', '福邦證', '寬魚國際', '創惟', '亞元', '大宇資', '久威', '建達', '新普', '擎邦', '上奇', '業強', '廣運', '信音', '九豪', '普誠', '萬旭', '茂達', '訊達', '振曜', '得利影', '耕興', '頎邦', '驊宏資', '撼訊', '松上', '禾昌', '欣技', '捷波', '華電網', '久正', '昱泉', '統振', '亞銳士', '信昌電', '安碁', '立敦', '亞通', '橘子', '合晶', '幃翔', '新潤', '萬潤', '廣明', '萬泰科', '育富', '詩肯', '元大富櫃50', '海韻電', '艾華', '雷科', '日揚', '慶生', '中探針', '富旺', '岳豐', '晉泰', '上揚', '旺矽', '茂綸', '系微', '旺玖', '高僑', '驊訊', '茂迪', '立端', '百徽', '久元', '普萊德', '方土昶', '泰詠', '倍微', '台燿', '元山', '安鈦克', '胡連', '佳邦', '良維', '沛亨', '迅德', '智基', '晶焱', '京晨科', '統新', '今展科', '大中', '迅得', '廣錠', '藥華藥', '紘康', '益得', '神盾', '大樹', '宇智', '保瑞', '點序', '互動', '環球晶', '生華科', '九齊', '科懋', '亞獅康-KY', '益安', '惠光', '聚和', '精測', '芮特-KY', '勤崴國際', '達爾膚', '明達醫', '創威', '瑞耘', '順藥', '倉和', '高端疫苗', '長科*', '欣普羅', '是方', '宏觀', '維田', '逸達', '勁豐', '達邦蛋白', '東典光電', '台康生技', '普鴻', '展匯科', '富強鑫', '奈米醫材', '朋億', '特昇-KY', '萬年清', '泰金-KY', '富致', 'M31', '天正國際', '樂斯科', '群翊', '信紘科', '鈺太', '雍智科技', '安碁資訊', '東捷資訊', '應廣', '昇佳電子', '崑鼎', '佑華', '鈦昇', '榮群', '長園科', '九暘', '金山電', '蜜望實', '網家', '德勝', '晶采', '廣積', '安國', '凱碩', '東捷', '來思達', '元太', '伍豐', '瑞穎', '巨虹', '福華', '宏捷科', '品安', '翔名', '建暐', '擎亞', '大世科', '大億金茂', '博大', '立碁', '越峰', '正淩', '博智', '天宇', '加高', '精星', '新漢', '華宏', '朋程', '商丞', '生展', '三竹', '泰藝', '群聯', '恒耀', '金居', '千附', '金益鼎', '盛弘', '金可-KY', '商之器', '森田', '大國鋼', '旭源', '紅木-KY', '匯鑽科', '東生華', '弘帆', '鉅邁', '大江', '大地-KY', '華研', '台境', '創業家', '三貝德', '光隆', '光隆甲特', '大田', '鉅明', '富堡', '宏大', '愛地雅', '國統', '明安', '森鉅', '皇田', '富邦存股雙十N', '統一漲升股利150N', '永昌富櫃200N', '元大富櫃200N', '永豐富櫃200N']

cityname=['台灣', '台北', '新北市', '高雄', '彰化', '基隆', '澎湖', '旗山', '嘉義', '竹東', '恆春', '苗栗', '豐原', '大武', '宜蘭', '台北', '高雄', '台中', '台南', '彰化', '中壢', '新竹', '新店', '花蓮', '基隆', '屏東', '台東', '佳里', '清水', '二林', '宜蘭', '岡山', '觀音', '鹿港', '龍潭', '麻豆', '南投', '布袋', '石岡', '蘇澳', '大園', '大甲', '淡水', '斗南', '東港', '鶯歌', '新化', '新社', '金山', '枋山', '和平', '關山', '三芝', '三灣', '萬里', '玉井', '南澳', '虎尾', '雙溪', '桃園國際機場', '高雄國際機場', '新竹', '花蓮', '宜蘭', '苗栗', '南投', '屏東', '台東', '桃園', '雲林', '台北', '台北', '新竹', '台中', '彰化', '高雄', '屏東', '台灣', '台南', '新竹', '嘉義', '台中', '南區', '淡水', '花蓮', '桃園', '連江', '金門', '太魯閣國家公園', '嘉義']
citynumber=[20070335, 20070568, 20070569, 20070570, 20070572, 22695855, 22695856, 2295794, 2296315, 2296872, 2297839, 2301128, 2303611, 2304594, 2347336, 2306179, 2306180, 2306181, 2306182, 2306183, 2306184, 2306185, 2306186, 2306187, 2306188, 2306189, 2306190, 2306193, 2306194, 2306195, 2306198, 2306199, 2306200, 2306201, 2306202, 2306203, 2306204, 2306206, 2306207, 2306208, 2306209, 2306210, 2306211, 2306212, 2306213, 2306214, 2306217, 2306218, 2306223, 2306224, 2306226, 2306227, 2306228, 2306229, 2306231, 2306232, 2306243, 2306250, 2306251, 2306254, 2306255, 2347334, 2347335, 2347336, 2347338, 2347339, 2347340, 2347344, 2347345, 2347346, 12703515, 12703525, 12703534, 12703539, 12703543, 12703556, 12703563, 23424971, 28751581, 28751582, 28751583, 28751584, 28752011, 28752322, 28752396, 28752472, 28760734, 28760735, 55863654, 7153409]
area_pm25=['二林', '三重', '三義', '土城', '士林', '大同', '大里', '大園', '大寮', '小港', '中山', '中壢', '仁武', '斗六', '冬山', '古亭', '左營', '平鎮', '永和', '安南', '朴子', '汐止', '竹山', '竹東', '西屯', '沙鹿', '宜蘭', '忠明', '松山', '板橋', '林口', '林園', '花蓮', '金門', '前金', '前鎮', '南投', '屏東', '屏東(琉球)', '恆春', '美濃', '苗栗', '埔里', '桃園', '馬公', '馬祖', '基隆', '崙背', '淡水', '麥寮', '善化', '富貴角', '復興', '湖口', '菜寮', '陽明', '新竹', '新店', '新莊', '新港', '新營', '楠梓', '萬里', '萬華', '嘉義', '彰化', '彰化(大城)', '臺西', '臺東', '臺南', '臺南(北門)', '臺南(麻豆)', '鳳山', '潮州', '線西', '橋頭', '頭份', '龍潭', '豐原', '關山', '觀音']






input_text='旗山天氣' #input_text
if '天氣' in input_text:
    p1="\D?\D\D天氣"
    patten=re.compile(p1)
    text=(patten.findall(input_text))[0].replace('天氣','')
    if text in cityname:
        print(text)
    
elif '空氣' in input_text:
    p1="\D?\D\D空氣"
    patten=re.compile(p1)
    text=(patten.findall(input_text))[0].replace('空氣','')
    if text in area_pm25:
        
        url = 'http://opendata.epa.gov.tw/webapi/Data/REWIQA/?$orderby=SiteName&$skip=0&$top=1000&format=json'
        gets = requests.get(url)
        df=pd.read_json(gets.text)
        df2=df[['SiteName','County','AQI','Status','PM2.5']]
        mask=  df2['SiteName'].values==input_text
        sear=df2[mask]
        retext=''
        for i in sear.values:
            retext += '地區: %s'%i[0]+'\n'
            retext += '縣市: %s'%i[1]+'\n'
            retext += '品值: %s'%i[3]+'\n'
            retext += 'AQI: %s'%i[2]+'\n'
            retext += 'PM2.5: %s'%i[4]+'\n'
        

        

        
        
